"use client";
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";
import { useEffect, useRef } from "react";
import Mission from "./Mission";

gsap.registerPlugin(ScrollTrigger);
gsap.config({
  nullTargetWarn: false,
});

const IntroductionItem = ({
  rogyx,
  text,
  link,
}: {
  rogyx: string;
  text: string;
  link: string;
}) => (
  <div>
    <div className="flex justify-center gap-[3vw] md:gap-8 items-center">
      <p className="md:text-[55px] lg:text-[80px] text-[7vw] font-lalezar leading-none">
        <span className="md:text-[75px] lg:text-[100px] text-[8vw]">ROGYX</span>
        {rogyx}
      </p>
      <a
        href={link}
        className="flex items-center justify-center md:flex-[0_0_103px] flex-[0_0_10vw] size-[10vw] md:size-[103px] bg-[#D9D9D9] rounded-full duration-150 hover:opacity-75"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 54 15"
          fill="none"
          className="md:w-[54px] w-[8vw]"
        >
          <path
            d="M53.5852 8.20711C53.9757 7.81658 53.9757 7.18342 53.5852 6.79289L47.2212 0.428932C46.8307 0.0384078 46.1975 0.0384078 45.807 0.428932C45.4165 0.819457 45.4165 1.45262 45.807 1.84315L51.4638 7.5L45.807 13.1569C45.4165 13.5474 45.4165 14.1805 45.807 14.5711C46.1975 14.9616 46.8307 14.9616 47.2212 14.5711L53.5852 8.20711ZM0.75 8.5H52.878V6.5H0.75V8.5Z"
            fill="black"
          />
        </svg>
      </a>
    </div>
    <p className="text-center md:text-[30px] text-[5vw] leading-none">
      {text}
    </p>
  </div>
);

const Introduction = () => {
  const introductionContainer = useRef<HTMLDivElement>(null);
  const blobTitle = useRef<SVGPathElement>(null);

  useEffect(() => {
    let shapes = [
      "M951.5 596.5C946.127 600.346 940.051 604 946.401 607.369C952.751 610.738 955.312 605.54 961.487 604.641C967.662 603.742 969.144 607.65 974.71 604.641C980.276 601.632 976.254 597.929 967.451 593.103C958.648 588.277 956.873 592.654 951.5 596.5Z",
      "M876.908 538.741C834.342 575.722 831.001 664.647 850.243 686.665C869.485 708.683 900.78 637.377 953.876 626.814C1006.97 616.251 1045.97 666.433 1062.63 644.414C1079.28 622.395 1097.86 555.458 1051.43 529.04C1005 502.622 919.474 501.76 876.908 538.741Z",
      "M776.08 567.923C730.665 651.553 752.28 744.856 798.261 770.148C844.242 795.44 867.177 683.308 960.017 669.088C1052.86 654.868 1164.64 771.632 1169.62 713.268C1174.59 654.904 1078.3 471.968 979.917 435.629C881.531 399.29 821.499 484.293 776.08 567.923Z",
      "M655.283 504.347C546.083 618.242 569.777 765.173 655.283 827.133C740.789 889.093 827.718 780.378 997.305 752.188C1166.89 723.998 1309.94 809.529 1333.63 714.371C1357.33 619.213 1261.67 424.061 1092.08 371.556C922.498 319.051 764.484 390.453 655.283 504.347Z",
      "M525.64 424.909C475.028 630.663 414.525 781.501 525.64 883.203C636.755 984.905 800.24 851.675 970.101 831.716C1139.96 811.757 1426.11 970.963 1453.18 855.085C1480.25 739.207 1310.27 475.748 1078.38 368.204C846.501 260.66 576.252 219.155 525.64 424.909Z",
      "M481.24 438.44 C466.5 662.28 355.35 811.07 481.24 908.75 607.14 1006.43 773.76 850.8 984.82 829.17 1195.89 807.55 1449.65 1007.2 1491.64 875.75 1533.63 744.3 1370.07 447.07 1117.47 337.75 864.87 228.42 495.99 214.6 481.24 438.44",
      "M374.273 471.064C445.958 738.481 212.763 882.322 374.273 970.322C535.783 1058.32 709.968 848.711 1020.31 823.062C1330.66 797.413 1506.39 1094.52 1584.32 925.562C1662.26 756.599 1514.18 377.995 1211.67 264.372C909.159 150.749 302.589 203.646 374.273 471.064Z",
      "M214.114 365.731C444.381 665.775 144.236 963.308 373.614 1110.77C602.992 1258.23 774.007 1002.78 1118.02 933.955C1462.03 865.126 1720.47 1086.41 1749.67 835.455C1778.87 584.498 1454.93 182.928 1072.93 84.8671C690.923 -13.1939 -16.153 65.6852 214.114 365.731Z",
      "M103.37 323.9 C372.59 684.61 -54.75 1039.6 296.32 1216.02 647.41 1392.43 822.43 1057.84 1146.99 1014.46 1471.57 971.08 1697.49 1277.65 1840.67 912.05 1983.84 546.45 1504.26 27.55 1063.58 -41.47 622.91 -110.5 -165.84 -36.8 103.37 323.9",
      "M30.25 296.29 C325.2 697.06 -186.14 1089.99 245.3 1285.52 676.74 1481.04 854.41 1094.2 1166.13 1067.62 1477.87 1041.04 1682.33 1403.93 1900.76 962.63 2119.18 521.34 1536.84 -75.04 1057.42 -124.9 578.01 -174.75 -264.68 -104.47 30.25 296.29",
      "M-25.9215 275.08C288.788 706.628 -287.094 1128.71 206.097 1338.92C699.287 1549.13 878.982 1122.14 1180.84 1108.47C1482.71 1094.8 1670.68 1500.96 1946.93 1001.5C2223.17 502.049 1561.87 -153.873 1052.69 -188.999C543.518 -224.125 -340.631 -156.467 -25.9215 275.08Z",
      "M-78.79 263.65 C256.68 752.51 -311.43 1168.06 176.68 1384.56 664.79 1601.05 852.78 1149.1 1176.72 1128.64 1500.67 1108.19 1730.09 1558.14 2002.78 1037.72 2275.46 517.3 1626.52 -166.12 1101.18 -220.3 575.85 -274.47 -414.26 -225.19 -78.79 263.65",
      "M-167.12 244.58 C203.05 829.19 -352.09 1233.81 127.54 1460.81 607.18 1687.81 809.03 1194.15 1169.85 1162.36 1530.68 1130.57 1829.37 1653.68 2096.1 1098.24 2362.82 542.8 1734.55 -186.6 1182.21 -272.6 629.88 -358.6 -537.29 -340.02 -167.12 244.58",
      "M-232.9 230.37 C163.1 886.29 -382.37 1282.78 90.94 1517.6 564.26 1752.42 776.43 1227.7 1164.73 1187.47 1553.03 1147.23 1903.31 1724.83 2165.6 1143.31 2427.88 561.79 1815 -201.85 1242.55 -311.55 670.11 -421.25 -628.92 -425.54 -232.9 230.37",
      "M-338.19 207.63 C99.17 977.7 -430.84 1361.16 32.36 1608.51 495.58 1855.85 724.27 1281.41 1156.53 1227.66 1588.81 1173.91 2021.65 1838.72 2276.84 1215.46 2532.02 592.19 1943.78 -226.26 1339.14 -373.9 734.52 -521.53 -775.58 -562.42 -338.19 207.63",
      "M-405.11 193.19 C58.56 1035.79 -461.65 1410.98 -4.85 1666.28 451.94 1921.58 691.13 1315.54 1151.33 1253.2 1611.55 1190.87 2096.86 1911.1 2347.53 1261.31 2598.2 611.51 2025.62 -241.78 1400.53 -413.52 775.45 -585.26 -868.78 -649.41 -405.11 193.19",
      "M-537.23 164.65 C-21.66 1150.49 -522.47 1509.34 -78.35 1780.35 365.75 2051.36 625.67 1382.93 1141.05 1303.63 1656.44 1224.34 2245.36 2054.01 2487.12 1351.84 2728.88 649.65 2187.22 -272.41 1521.74 -491.75 856.27 -711.09 -1052.82 -821.18 -537.23 164.65",
      "M-638.992 142.686C-83.4399 1238.83 -569.324 1585.09 -134.968 1868.2C299.388 2151.31 575.265 1434.83 1133.14 1342.48C1691.02 1250.13 2359.73 2164.08 2594.62 1421.56C2829.52 679.03 2311.67 -296.012 1615.09 -552.01C918.51 -808.009 -1194.55 -953.46 -638.992 142.686Z",
      "M-750.56 108.93 C-204.06 1247.23 -704.59 1638.67 -211.32 1933.87 281.94 2229.06 564.25 1499.32 1127.32 1408.12 1690.39 1316.92 2383.19 2278.84 2676.22 1472.08 2969.25 665.31 2413.57 -386.4 1655.38 -633.27 897.2 -880.14 -1297.07 -1029.36 -750.56 108.93",
      "M-894.84 65.29 C-360.04 1258.1 -879.5 1707.96 -310.05 2018.78 259.38 2329.59 550.01 1582.71 1119.79 1493 1689.58 1403.29 2413.52 2427.23 2781.73 1537.41 3149.94 647.58 2545.33 -503.29 1707.49 -738.35 869.65 -973.41 -1429.65 -1127.5 -894.84 65.29",
      "M-1131.22 -6.19 C-615.59 1275.92 -1166.08 1821.5 -471.82 2157.91 222.42 2494.31 526.69 1719.35 1107.47 1632.08 1688.26 1544.8 2463.23 2670.35 2954.6 1644.45 3445.97 618.54 2761.21 -694.8 1792.87 -910.51 824.53 -1126.22 -1646.86 -1288.31 -1131.22 -6.19",
      "M-3588.32 -749.38C-3271.96 1461.07 -4144.98 3001.64 -2153.36 3604.09C-161.732 4206.54 284.229 3139.61 979.37 3077.7C1674.51 3015.78 2979.92 5197.55 4751.56 2757.09C6523.19 316.641 5005.22 -2685.47 2680.32 -2700.06C355.416 -2714.66 -3904.69 -2959.83 -3588.32 -749.38Z",
    ];

    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: introductionContainer.current,
        start: "top top",
        end: "+=5000",
        pin: true,
        scrub: true,
        onUpdate: (self) => {
          const progress = self.progress;
          const index = Math.floor(progress * (shapes.length - 1));
          console.log(index);
          if (blobTitle.current) {
            blobTitle.current.setAttribute("d", shapes[index]);
            if (index === 0) {
              blobTitle.current.setAttribute("d", '');
            }
          }
        },
      },
    });

    return () => {
      tl.scrollTrigger?.refresh();
      tl.kill();
    };
  }, []);

  return (
    <section className="relative overflow-hidden">
      <div ref={introductionContainer} className="relative w-full">
        <div className="absolute top-0 inset-x-0 w-screen h-screen flex items-center justify-center">
          <Mission />
        </div>

        <div className="w-screen bg-[#DDDDDD] [clip-path:url('#maskTitle')]">
          <svg className="maskSvg inset-0 absolute">
            <defs>
              <clipPath
                id="maskTitle"
                clipPathUnits="objectBoundingBox"
                transform="scale(0.0005, 0.00033333333333333)"
              >
                <path
                  ref={blobTitle}
                  id="blobTitle"
                  fill="#fff"
                  d=""
                />
              </clipPath>
            </defs>
          </svg>
          <div className="">
            <div className="flex flex-col items-center justify-center min-h-[120vh] md:gap-[180px] gap-[100px] md:py-[200px] py-[120px]">
              <IntroductionItem rogyx="の特徴" text="ROGYXの特徴を2つの柱" link="/" />
              <IntroductionItem rogyx="の考え方" text="ROGYXの特徴を2つの柱" link="/" />
              <IntroductionItem rogyx="ってこんな会社" text="ROGYXの特徴を2つの柱" link="/" />
            </div>
          </div>
        </div>
      </div>
    </section>
  );
};

export default Introduction;
